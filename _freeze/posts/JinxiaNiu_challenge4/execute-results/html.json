{
  "hash": "b5f53881e7e2d8b35c5dacc4ac52b4bb",
  "result": {
    "markdown": "---\ntitle: \"Challenge 4 by Jinxia Niu\"\nauthor: \"Jinxia Niu\"\ndescription: \"More data wrangling: pivoting\"\ndate: \"03/25/2023\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - challenge_4\n  - hotel_bookings\n  - Jinxia Niu\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n\nknitr::opts_chunk$set(echo = TRUE, warning=FALSE, message=FALSE)\n```\n:::\n\n\n## Challenge Overview\n\nToday's challenge is to:\n\n1)  read in a data set, and describe the data set using both words and any supporting information (e.g., tables, etc)\n2)  tidy data (as needed, including sanity checks)\n3)  identify variables that need to be mutated\n4)  mutate variables and sanity check all mutations\n\n## Read in data\n\nRead in one (or more) of the following datasets, using the correct R package and command.\n\n-   abc_poll.csv ⭐\n-   poultry_tidy.xlsx or organiceggpoultry.xls⭐⭐\n-   FedFundsRate.csv⭐⭐⭐\n-   hotel_bookings.csv⭐⭐⭐⭐\n-   debt_in_trillions.xlsx ⭐⭐⭐⭐⭐\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nhotel_bookings<- read.csv(\"_data/hotel_bookings.csv\")\ndim(hotel_bookings)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 119390     32\n```\n:::\n\n```{.r .cell-code}\nhead(hotel_bookings,10)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          hotel is_canceled lead_time arrival_date_year arrival_date_month\n1  Resort Hotel           0       342              2015               July\n2  Resort Hotel           0       737              2015               July\n3  Resort Hotel           0         7              2015               July\n4  Resort Hotel           0        13              2015               July\n5  Resort Hotel           0        14              2015               July\n6  Resort Hotel           0        14              2015               July\n7  Resort Hotel           0         0              2015               July\n8  Resort Hotel           0         9              2015               July\n9  Resort Hotel           1        85              2015               July\n10 Resort Hotel           1        75              2015               July\n   arrival_date_week_number arrival_date_day_of_month stays_in_weekend_nights\n1                        27                         1                       0\n2                        27                         1                       0\n3                        27                         1                       0\n4                        27                         1                       0\n5                        27                         1                       0\n6                        27                         1                       0\n7                        27                         1                       0\n8                        27                         1                       0\n9                        27                         1                       0\n10                       27                         1                       0\n   stays_in_week_nights adults children babies meal country market_segment\n1                     0      2        0      0   BB     PRT         Direct\n2                     0      2        0      0   BB     PRT         Direct\n3                     1      1        0      0   BB     GBR         Direct\n4                     1      1        0      0   BB     GBR      Corporate\n5                     2      2        0      0   BB     GBR      Online TA\n6                     2      2        0      0   BB     GBR      Online TA\n7                     2      2        0      0   BB     PRT         Direct\n8                     2      2        0      0   FB     PRT         Direct\n9                     3      2        0      0   BB     PRT      Online TA\n10                    3      2        0      0   HB     PRT  Offline TA/TO\n   distribution_channel is_repeated_guest previous_cancellations\n1                Direct                 0                      0\n2                Direct                 0                      0\n3                Direct                 0                      0\n4             Corporate                 0                      0\n5                 TA/TO                 0                      0\n6                 TA/TO                 0                      0\n7                Direct                 0                      0\n8                Direct                 0                      0\n9                 TA/TO                 0                      0\n10                TA/TO                 0                      0\n   previous_bookings_not_canceled reserved_room_type assigned_room_type\n1                               0                  C                  C\n2                               0                  C                  C\n3                               0                  A                  C\n4                               0                  A                  A\n5                               0                  A                  A\n6                               0                  A                  A\n7                               0                  C                  C\n8                               0                  C                  C\n9                               0                  A                  A\n10                              0                  D                  D\n   booking_changes deposit_type agent company days_in_waiting_list\n1                3   No Deposit  NULL    NULL                    0\n2                4   No Deposit  NULL    NULL                    0\n3                0   No Deposit  NULL    NULL                    0\n4                0   No Deposit   304    NULL                    0\n5                0   No Deposit   240    NULL                    0\n6                0   No Deposit   240    NULL                    0\n7                0   No Deposit  NULL    NULL                    0\n8                0   No Deposit   303    NULL                    0\n9                0   No Deposit   240    NULL                    0\n10               0   No Deposit    15    NULL                    0\n   customer_type   adr required_car_parking_spaces total_of_special_requests\n1      Transient   0.0                           0                         0\n2      Transient   0.0                           0                         0\n3      Transient  75.0                           0                         0\n4      Transient  75.0                           0                         0\n5      Transient  98.0                           0                         1\n6      Transient  98.0                           0                         1\n7      Transient 107.0                           0                         0\n8      Transient 103.0                           0                         1\n9      Transient  82.0                           0                         1\n10     Transient 105.5                           0                         0\n   reservation_status reservation_status_date\n1           Check-Out              2015-07-01\n2           Check-Out              2015-07-01\n3           Check-Out              2015-07-02\n4           Check-Out              2015-07-02\n5           Check-Out              2015-07-03\n6           Check-Out              2015-07-03\n7           Check-Out              2015-07-03\n8           Check-Out              2015-07-03\n9            Canceled              2015-05-06\n10           Canceled              2015-04-22\n```\n:::\n:::\n\n### Briefly describe the data\nIt's a hotel booking data set of 32 variables,119390 observations.There are several redundant variables, especially the arrival date_year,arrival_date_month and arrival_date_day_of_the_month ones.\n\n## Identify variables that need to be mutated\n\nWe need to use mutate() and make_date() from the lubridate package to create just one date format. In addition, because the arrival-month is currently shown as characters(eg.July, August) instead of numbers, we also need to use case_when() from the dplyr package to convert them first into numbers.\n\n##Note:The case_when() function from the dplyr package in R can be used to create new variables from existing variables.\n\nThis function uses the following basic syntax:\n\nlibrary(dplyr)\n\ndf %>%\n  mutate(new_var = case_when(var1 < 15 ~ 'low',\n                             var2 < 25 ~ 'med',\n                             TRUE ~ 'high'))\nNote that TRUE is equivalent to an “else” statement.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(lubridate)\nhotel_bookings <- hotel_bookings %>%\n    mutate(month = case_when(\n       arrival_date_month == \"January\" ~ 1,\n       arrival_date_month == \"February\" ~ 2,\n       arrival_date_month == \"March\" ~ 3,\n       arrival_date_month == \"April\" ~ 4,\n       arrival_date_month == \"May\" ~ 5,\n       arrival_date_month == \"June\" ~ 6,\n       arrival_date_month == \"July\" ~ 7,\n       arrival_date_month == \"August\" ~ 8,\n       arrival_date_month == \"September\" ~ 9,\n       arrival_date_month == \"October\" ~ 10,\n       arrival_date_month == \"November\" ~ 11,\n       arrival_date_month == \"December\" ~ 12,\n     )) %>%\n    mutate(arrival_date = make_date(arrival_date_year, month, arrival_date_day_of_month)) %>%\n    select(-c(arrival_date_year, arrival_date_month, arrival_date_day_of_month, month, arrival_date_week_number)) %>%\n    select(hotel, arrival_date, everything())\ndim(hotel_bookings)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 119390     29\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}