{
  "hash": "667ef82218136e45c76f5476f9073ed5",
  "result": {
    "markdown": "---\ntitle: \"Challenge 5 - StateCounty Visualizations\"\nauthor: \"Joseph Vincent\"\ndescription: \"Introduction to Visualization\"\ndate: \"03/29/2023\"\nformat:\n  html:\n    toc: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - state_county\n  - Joseph Vincent\n  - challenge_5\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(readxl)\n\nknitr::opts_chunk$set(echo = TRUE, warning=FALSE, message=FALSE)\n```\n:::\n\n\n## Reading in StateCounty data\n\n-   StateCounty2012.xls ⭐⭐⭐\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#reading in StateCounty data\n#skipping first 2 blank rows\n#Selecting columns with data\n#Filtering out aggregate rows\n#Filtering out row with note about no addresx\nStateCounty <- read_xls(\"_data/StateCounty2012.xls\",\n                        skip = 2)\nStateCounty <- StateCounty %>%\n  select(STATE, COUNTY, TOTAL) %>%\n  filter(!str_detect(STATE, \"address\"))\n\nhead(StateCounty)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 3\n  STATE     COUNTY               TOTAL\n  <chr>     <chr>                <dbl>\n1 AE        APO                      2\n2 AE Total1 <NA>                     2\n3 AK        ANCHORAGE                7\n4 AK        FAIRBANKS NORTH STAR     2\n5 AK        JUNEAU                   3\n6 AK        MATANUSKA-SUSITNA        2\n```\n:::\n\n```{.r .cell-code}\n#recoding the military designation observation\nStateCounty[2986, 1] = \"MILITARY\"\nStateCounty[2986, 3] = 1\ntail(StateCounty)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 3\n  STATE       COUNTY    TOTAL\n  <chr>       <chr>     <dbl>\n1 WY          WASHAKIE     10\n2 WY          WESTON       37\n3 WY Total    <NA>       2876\n4 Grand Total <NA>     255432\n5 CANADA      <NA>        662\n6 MILITARY    <NA>          1\n```\n:::\n\n```{.r .cell-code}\n#finding the number of counties excluding aggregates\nStateCounty %>%\n  filter(!str_detect(STATE, \"Total\")) %>%\n  dim_desc()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"[2,932 x 3]\"\n```\n:::\n\n```{.r .cell-code}\n#finding the mean and median by state\nStateCounty %>%\n  filter(str_detect(STATE, \"Total\")) %>%\n  summarize(Mean = mean(TOTAL, na.rm = TRUE),\n            Median = median(TOTAL, na.rm = TRUE),\n            Max = max(TOTAL, na.rm = TRUE),\n            Min = min(TOTAL, na.rm = TRUE))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 4\n   Mean Median    Max   Min\n  <dbl>  <dbl>  <dbl> <dbl>\n1 9460.  3514. 255432     1\n```\n:::\n\n```{.r .cell-code}\n#finding the mean and median by county\nStateCounty %>%\n  filter(!str_detect(STATE, \"Total\")) %>%\n  summarize(Mean = mean(TOTAL, na.rm = TRUE),\n            Median = median(TOTAL, na.rm = TRUE),\n            Max = max(TOTAL, na.rm = TRUE),\n            Min = min(TOTAL, na.rm = TRUE))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 4\n   Mean Median   Max   Min\n  <dbl>  <dbl> <dbl> <dbl>\n1  87.3     21  8207     1\n```\n:::\n:::\n\n\n### Briefly describe the data\n\nThe StateCounty dataset is describing the number of employees for a specific organization in each county of the United States. There are also aggregate values for number of employees in each state. There are is also data on the number of employees in Canada and on military bases abroad.\n\nThere are a total of 2,932 counties with employees. They are spread across all US states.\n\nThe largest state has over 250,000 emoployees, with the state mean being around 9,000 and the state median being around 3,500.\n\nThe largest individual county has over 8,000 employees, with the county mean being around 90 employees and the county median being about 20.\n\n## Tidy Data (as needed)\n\nThe data is already tidy, but as you can see the aggregate state totals will need to be accounted for when the data is analyzed and visualized.\n\nThe single military base employee was missing data, and this has been corrected.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nunique(StateCounty$STATE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  [1] \"AE\"          \"AE Total1\"   \"AK\"          \"AK Total\"    \"AL\"         \n  [6] \"AL Total\"    \"AP\"          \"AP Total1\"   \"AR\"          \"AR Total\"   \n [11] \"AZ\"          \"AZ Total\"    \"CA\"          \"CA Total\"    \"CO\"         \n [16] \"CO Total\"    \"CT\"          \"CT Total\"    \"DC\"          \"DC Total\"   \n [21] \"DE\"          \"DE Total\"    \"FL\"          \"FL Total\"    \"GA\"         \n [26] \"GA Total\"    \"HI\"          \"HI Total\"    \"IA\"          \"IA Total\"   \n [31] \"ID\"          \"ID Total\"    \"IL\"          \"IL Total\"    \"IN\"         \n [36] \"IN Total\"    \"KS\"          \"KS Total\"    \"KY\"          \"KY Total\"   \n [41] \"LA\"          \"LA Total\"    \"MA\"          \"MA Total\"    \"MD\"         \n [46] \"MD Total\"    \"ME\"          \"ME Total\"    \"MI\"          \"MI Total\"   \n [51] \"MN\"          \"MN Total\"    \"MO\"          \"MO Total\"    \"MS\"         \n [56] \"MS Total\"    \"MT\"          \"MT Total\"    \"NC\"          \"NC Total\"   \n [61] \"ND\"          \"ND Total\"    \"NE\"          \"NE Total\"    \"NH\"         \n [66] \"NH Total\"    \"NJ\"          \"NJ Total\"    \"NM\"          \"NM Total\"   \n [71] \"NV\"          \"NV Total\"    \"NY\"          \"NY Total\"    \"OH\"         \n [76] \"OH Total\"    \"OK\"          \"OK Total\"    \"OR\"          \"OR Total\"   \n [81] \"PA\"          \"PA Total\"    \"RI\"          \"RI Total\"    \"SC\"         \n [86] \"SC Total\"    \"SD\"          \"SD Total\"    \"TN\"          \"TN Total\"   \n [91] \"TX\"          \"TX Total\"    \"UT\"          \"UT Total\"    \"VA\"         \n [96] \"VA Total\"    \"VT\"          \"VT Total\"    \"WA\"          \"WA Total\"   \n[101] \"WI\"          \"WI Total\"    \"WV\"          \"WV Total\"    \"WY\"         \n[106] \"WY Total\"    \"Grand Total\" \"CANADA\"      \"MILITARY\"   \n```\n:::\n:::\n\n\nBefore creating some visualizations of the data, it will be easier to create two data sets that include the county totals and state totals respectively.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#creating a dataset without aggregates for ease of plotting\nStateCountyNoAggregates <- StateCounty %>%\n  filter(!str_detect(STATE, \"Total\"))\n\nunique(StateCountyNoAggregates$STATE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"AE\"       \"AK\"       \"AL\"       \"AP\"       \"AR\"       \"AZ\"      \n [7] \"CA\"       \"CO\"       \"CT\"       \"DC\"       \"DE\"       \"FL\"      \n[13] \"GA\"       \"HI\"       \"IA\"       \"ID\"       \"IL\"       \"IN\"      \n[19] \"KS\"       \"KY\"       \"LA\"       \"MA\"       \"MD\"       \"ME\"      \n[25] \"MI\"       \"MN\"       \"MO\"       \"MS\"       \"MT\"       \"NC\"      \n[31] \"ND\"       \"NE\"       \"NH\"       \"NJ\"       \"NM\"       \"NV\"      \n[37] \"NY\"       \"OH\"       \"OK\"       \"OR\"       \"PA\"       \"RI\"      \n[43] \"SC\"       \"SD\"       \"TN\"       \"TX\"       \"UT\"       \"VA\"      \n[49] \"VT\"       \"WA\"       \"WI\"       \"WV\"       \"WY\"       \"CANADA\"  \n[55] \"MILITARY\"\n```\n:::\n\n```{.r .cell-code}\n#creating a dataset with only the state aggregates for ease of plotting\nStateCountyAggregates <- StateCounty %>%\n  filter(str_detect(STATE, \"Total\")) %>%\n  filter(!str_detect(STATE, \"Grand Total\")) %>%\n  select(STATE, TOTAL) %>%\n  separate(STATE, into = c(\"STATE\", \"delete\"), sep = \" \") %>%\n  select(STATE, TOTAL)\n\nhead(StateCountyAggregates)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 2\n  STATE TOTAL\n  <chr> <dbl>\n1 AE        2\n2 AK      103\n3 AL     4257\n4 AP        1\n5 AR     3871\n6 AZ     3153\n```\n:::\n:::\n\n\n## Univariate Visualizations\n\nBelow you can see a few different distributions:\nThe first is a plot of the distribution of county employee totals, for those containing less than 500 employees. This was done as there are some extreme outliers in the data set that would make it harder to visualize.\n\nAs you can see, the vast majority of counties have a small number of employees.\n\nIn the second plot, you can see the distribution of state employee totals. Most states have around 5,000 or fewer employees, but there are some outliers which will be further described in later plots.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Plotting the distribution of county employee totals\nStateCountyNoAggregates %>%\n  filter(TOTAL < 500) %>%\n  ggplot(aes(TOTAL)) +\n    geom_histogram(binwidth=3, fill=\"#b3697a\", alpha=0.9) +\n    ggtitle(\"Distribution of County Employees (Fewer than 500)\")\n```\n\n::: {.cell-output-display}\n![](JosephVincent_challenge5_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#plotting the distribution of state employee totals\nggplot(StateCountyAggregates, aes(TOTAL)) +\n  geom_histogram(fill=\"#69b3a2\", alpha = 0.9) +\n  ggtitle(\"Distribution of State Employees\")\n```\n\n::: {.cell-output-display}\n![](JosephVincent_challenge5_files/figure-html/unnamed-chunk-5-2.png){width=672}\n:::\n:::\n\n\n## Bivariate Visualization(s)\n\nNext we will take a look at a detailed breakdown of employees by state.\nThe two bar-plots below make it easy to visualize the number of employees in each state and their order.\nI split this into two charts, one above the mean and one below the mean, simply to declutter the plots and make them easier to read.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#plotting distribution of employees by state for those with over 2000 employees\n#using fct_reorder to order from greatest to least\nStateCountyAggregates %>%\n  filter(TOTAL >= 3500) %>%\n  mutate(STATE = fct_reorder(STATE, TOTAL)) %>%\n  ggplot(aes(x=STATE, y=TOTAL)) + \n  geom_bar(stat = \"identity\", fill=\"#f68060\", alpha=.6, width=.8) + \n  coord_flip() +\n  ggtitle(\"Employees By State (>=3500)\")\n```\n\n::: {.cell-output-display}\n![](JosephVincent_challenge5_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#plotting distribution of employees by state for those with less than 2000 employees\n#using fct_reorder to order from greatest to least\nStateCountyAggregates %>%\n  filter(TOTAL < 3500) %>%\n  mutate(STATE = fct_reorder(STATE, TOTAL)) %>%\n  ggplot(aes(x=STATE, y=TOTAL)) + \n  geom_bar(stat = \"identity\", fill=\"#a42678\", alpha=.6, width=.8) + \n  coord_flip() + \n  ggtitle(\"Employees By State (<3500)\")\n```\n\n::: {.cell-output-display}\n![](JosephVincent_challenge5_files/figure-html/unnamed-chunk-6-2.png){width=672}\n:::\n:::\n",
    "supporting": [
      "JosephVincent_challenge5_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}