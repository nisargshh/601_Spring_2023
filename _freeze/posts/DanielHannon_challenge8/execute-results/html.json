{
  "hash": "0f28898714ed69fcf521cec839ac322a",
  "result": {
    "markdown": "---\ntitle: \"SNL Joining\"\nauthor: \"Daniel Hannon\"\ndesription: \"Joined Multiple Dataframes about SNL cast data\"\ndate: \"05/02/2023\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - challenge_8\n  - Daniel Hannon\n  - snl\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(lubridate)\n\nknitr::opts_chunk$set(echo = TRUE)\n```\n:::\n\n\n## Read in the data \n\n\n::: {.cell}\n\n```{.r .cell-code}\nactors <- read.csv(\"_data/snl_actors.csv\")\n\ncasts <- read.csv(\"_data/snl_casts.csv\")\n\nseasons <- read.csv(\"_data/snl_seasons.csv\")\n\nhead(actors)  # (2,306 x 4)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n             aid           url  type  gender\n1  Kate McKinnon   /Cast/?KaMc  cast  female\n2    Alex Moffat   /Cast/?AlMo  cast    male\n3     Ego Nwodim   /Cast/?EgNw  cast unknown\n4     Chris Redd   /Cast/?ChRe  cast    male\n5 Kenan Thompson   /Cast/?KeTh  cast    male\n6 Carey Mulligan /Guests/?3677 guest    andy\n```\n:::\n\n```{.r .cell-code}\ncasts <- casts %>%  # (614 x 8)\n        mutate(first_epid = ymd(first_epid), last_epid = ymd(last_epid))\n\nseasons <- seasons %>% # (46 x 5)\n        mutate(first_epid = ymd(first_epid), last_epid = ymd(last_epid))\n```\n:::\n\n\n## Tidy the data\n\nThe data in the data frames are all independently tidy. The actors Data Frame is a list of all the actors, guests, musical guests, and crew that have appeared on the show. Each observation is for one actor and tells what type of role they played and their gender. The casts data frame has each observation be an actor on the cast during a specific season, and has information about whether they were featured, the dates of their first and last episode, whether or not the were an anchor on weekend update and the number of episodes they were in during that season. The seasons data frame has each observation as a specific season, and contains data on what year it ran, the dates of the first and last episodes and the number of episodes. \n\n## Join the data\n\nIn order to join the data we have to look at the connecting keys. Casts and seasons are connected by the sid (season ID) column, while casts and actors are connected by the aid (actor ID) column. First we will join the extra information provided in the actors df into the casts df to gain information about the actor's genders. We can also filter out all of the guests, musical guests, and crew because we are only going to be looking at data on the main cast. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nactors <-actors %>%\n       select(-url) %>%\n       filter(type == \"cast\")  ## 154 cast members here, missing David Spade and Gilbert Gottfried\n\ncasts %>%\n      select(aid)%>%\n      n_distinct()             ##Sanity Check: 156 cast members here \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 156\n```\n:::\n\n```{.r .cell-code}\ncasts <- full_join(actors, casts, by = \"aid\") %>%\n        select(c(aid, gender, sid, featured, update_anchor))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in full_join(actors, casts, by = \"aid\"): Each row in `x` is expected to match at most 1 row in `y`.\nℹ Row 1 of `x` matches multiple rows.\nℹ If multiple matches are expected, set `multiple = \"all\"` to silence this\n  warning.\n```\n:::\n:::\n\nNow that we have joined this information, we can do analysis on gender throughout the different seasons, as well as the gender breakdown of the weekend update hosts. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(casts) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            aid gender sid featured update_anchor\n1 Kate McKinnon female  37     True         False\n2 Kate McKinnon female  38     True         False\n3 Kate McKinnon female  39    False         False\n4 Kate McKinnon female  40    False         False\n5 Kate McKinnon female  41    False         False\n6 Kate McKinnon female  42    False         False\n```\n:::\n\n```{.r .cell-code}\ncasts %>%\n      filter(update_anchor == \"True\") %>%\n      select(gender)%>%\n      table() %>%\n      prop.table() # 74% of all weekend update hosts are male when looking at every season \n```\n\n::: {.cell-output .cell-output-stdout}\n```\ngender\n  female     male \n0.260274 0.739726 \n```\n:::\n\n```{.r .cell-code}\ncasts %>%\n      filter(update_anchor == \"True\") %>%\n      group_by(aid) %>%\n      slice(1) %>%\n      ungroup()%>%\n      select(gender)%>%\n      table() %>%\n      prop.table()   #69.5% of actors who host weekend update are male \n```\n\n::: {.cell-output .cell-output-stdout}\n```\ngender\n   female      male \n0.3043478 0.6956522 \n```\n:::\n:::\n\nBreaking down the gender of the weekend update hosts we can see that across all seasons 74% of the hosts are male, while looking at the percent of people that were hosts, 69.5% of them are male. In both cases we can see that the role of weekend update host is taken more by men than women. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nseasons <- casts %>%     #Create a Gender Percent breakdown for each season\n        group_by(sid) %>%\n        add_count(name = \"total\") %>%\n        group_by(sid, gender)%>%\n        add_count(name = \"gender_total\") %>%\n        mutate(gender_percent = gender_total/total) %>%\n        select(sid, gender, gender_percent) %>%\n        slice(1) %>%\n        full_join(seasons, by= \"sid\")\n\nseasons\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 102 × 7\n# Groups:   sid, gender [102]\n     sid gender gender_percent  year first_epid last_epid  n_episodes\n   <int> <chr>           <dbl> <int> <date>     <date>          <int>\n 1     1 female          0.333  1975 1975-10-11 1976-07-31         24\n 2     1 male            0.667  1975 1975-10-11 1976-07-31         24\n 3     2 female          0.375  1976 1976-09-18 1977-05-21         22\n 4     2 male            0.625  1976 1976-09-18 1977-05-21         22\n 5     3 female          0.333  1977 1977-09-24 1978-05-20         20\n 6     3 male            0.667  1977 1977-09-24 1978-05-20         20\n 7     4 female          0.333  1978 1978-10-07 1979-05-26         20\n 8     4 male            0.667  1978 1978-10-07 1979-05-26         20\n 9     5 female          0.2    1979 1979-10-13 1980-05-24         20\n10     5 male            0.8    1979 1979-10-13 1980-05-24         20\n# … with 92 more rows\n```\n:::\n:::\n\nWe now we have added in to the seasons a percentage breakdown for the gender of the cast and we have successfully joined all the data.\n",
    "supporting": [
      "DanielHannon_challenge8_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}