{
  "hash": "63bfaf982b6039d792581236291711c5",
  "result": {
    "markdown": "---\ntitle: \"Debt Time Graphing\"\nauthor: \"Daniel Hannon\"\ndesription: \"Created graphs vizualing changes over time to debt data\"\ndate: \"04/05/2023\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - challenge_6\n  - Daniel Hannon\n  - debt\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(lubridate)\n\nknitr::opts_chunk$set(echo = TRUE)\n```\n:::\n\n\n## Read in the Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndebt_data <- readxl::read_xlsx(\"_data/debt_in_trillions.xlsx\")\ndebt_data\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 74 × 8\n   `Year and Quarter` Mortgage HE Revolvin…¹ Auto …² Credi…³ Stude…⁴ Other Total\n   <chr>                 <dbl>         <dbl>   <dbl>   <dbl>   <dbl> <dbl> <dbl>\n 1 03:Q1                  4.94         0.242   0.641   0.688   0.241 0.478  7.23\n 2 03:Q2                  5.08         0.26    0.622   0.693   0.243 0.486  7.38\n 3 03:Q3                  5.18         0.269   0.684   0.693   0.249 0.477  7.56\n 4 03:Q4                  5.66         0.302   0.704   0.698   0.253 0.449  8.07\n 5 04:Q1                  5.84         0.328   0.72    0.695   0.260 0.446  8.29\n 6 04:Q2                  5.97         0.367   0.743   0.697   0.263 0.423  8.46\n 7 04:Q3                  6.21         0.426   0.751   0.706   0.33  0.41   8.83\n 8 04:Q4                  6.36         0.468   0.728   0.717   0.346 0.423  9.04\n 9 05:Q1                  6.51         0.502   0.725   0.71    0.364 0.394  9.21\n10 05:Q2                  6.70         0.528   0.774   0.717   0.374 0.402  9.49\n# … with 64 more rows, and abbreviated variable names ¹​`HE Revolving`,\n#   ²​`Auto Loan`, ³​`Credit Card`, ⁴​`Student Loan`\n```\n:::\n:::\n\nThe data is a tibble of size 74 x 8, telling the amount of Various types of debt active in every quarter of every year from Q1 2003, to Q2 2021. The types of debt are Mortgage, HE Revolving, Auto Loan, Credit Card, Student Loan, Other, and Total. \n\nIn order to better graph the data we will create a data column using lubridate.\n\n::: {.cell}\n\n```{.r .cell-code}\ndebt_data <- debt_data %>%\n          mutate(Date = yq(`Year and Quarter`))\n```\n:::\n\n## Tidy the Data\n\nIn the last assignment it was not always useful to have the data in a tidy format when graphing, so we will save it as a separate tibble\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndebt_tidy <- debt_data %>%\n          pivot_longer(cols= !c(`Year and Quarter`, Date), names_to = \"Debt Type\", values_to = \"Amount\") %>%\n          select(!`Year and Quarter`)\ndebt_tidy\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 518 × 3\n   Date       `Debt Type`  Amount\n   <date>     <chr>         <dbl>\n 1 2003-01-01 Mortgage      4.94 \n 2 2003-01-01 HE Revolving  0.242\n 3 2003-01-01 Auto Loan     0.641\n 4 2003-01-01 Credit Card   0.688\n 5 2003-01-01 Student Loan  0.241\n 6 2003-01-01 Other         0.478\n 7 2003-01-01 Total         7.23 \n 8 2003-04-01 Mortgage      5.08 \n 9 2003-04-01 HE Revolving  0.26 \n10 2003-04-01 Auto Loan     0.622\n# … with 508 more rows\n```\n:::\n:::\n\n\n## Sanity Check\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndebt_data %>%\n          select(!c(`Year and Quarter`, Date)) %>%\n          summarise_all(list(\"mean\"= mean, \"median\"= median, \"max\"= max, \"min\" = min))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 28\n  Mortgage_mean HE Rev…¹ Auto …² Credi…³ Stude…⁴ Other…⁵ Total…⁶ Mortg…⁷ HE Re…⁸\n          <dbl>    <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>\n1          8.27    0.516   0.931   0.757   0.919   0.383    11.8    8.41   0.516\n# … with 19 more variables: `Auto Loan_median` <dbl>,\n#   `Credit Card_median` <dbl>, `Student Loan_median` <dbl>,\n#   Other_median <dbl>, Total_median <dbl>, Mortgage_max <dbl>,\n#   `HE Revolving_max` <dbl>, `Auto Loan_max` <dbl>, `Credit Card_max` <dbl>,\n#   `Student Loan_max` <dbl>, Other_max <dbl>, Total_max <dbl>,\n#   Mortgage_min <dbl>, `HE Revolving_min` <dbl>, `Auto Loan_min` <dbl>,\n#   `Credit Card_min` <dbl>, `Student Loan_min` <dbl>, Other_min <dbl>, …\n```\n:::\n:::\n\n\n## Time Evolution Graph\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndebt_data %>%\n          ggplot(aes(y= Total, x= Date)) +\n          geom_line()+\n          geom_point()+\n          labs(title= \"Total Debt by Quarter\", y= \"Total Debt (in trillions)\", x= \"Fiscal Quarter\")+\n          theme_bw()\n```\n\n::: {.cell-output-display}\n![](DanielHannon_challenge6_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\nI chose to use a line graph and a point graph to make a connected scatter plot. I did this because the points are useful to know the exact points in time that represent the first date of each quarter, and the line helps to show the trend over time more clearly. If the points weren't there it would almost look like a continuous variable, and it would be hard to see where the exact measurements are.\n\n## Flow Relationship Graph\n\nHere we will use the tidy version of our data set. \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndebt_tidy %>%\n    filter(`Debt Type`!= \"Total\") %>%\n    ggplot(aes(x= Date, y=Amount, color= `Debt Type`)) + \n    geom_line(show.legend = TRUE) +\n    geom_point()+\n    theme_bw()+\n    labs(title= \"Debt Type Breakdown by Quarter\", x= \"Quarter\", y= \"Debt (in trillions)\")\n```\n\n::: {.cell-output-display}\n![](DanielHannon_challenge6_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\nUsing another line chart makes it hard to see all the non-mortgage debt, because they are all low and overlapping. For this reason the best graph to use seems to be a stacked graph.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndebt_tidy %>%\n    filter(`Debt Type`!= \"Total\") %>%\n    mutate(`Debt Type` =  fct_relevel(`Debt Type`, \"Mortgage\", \"Auto Loan\", \"Credit Card\", \"HE Revolving\", \"Other\", \"Student Loan\"))%>%\n    ggplot(aes(x= Date, y=Amount, fill= `Debt Type`)) + \n    geom_bar(show.legend = TRUE, stat = \"identity\")+ \n    theme_bw()+\n    labs(title= \"Debt Type Breakdown by Quarter\", x= \"Quarter\", y= \"Debt (in trillions)\")\n```\n\n::: {.cell-output-display}\n![](DanielHannon_challenge6_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\nWith a stacked bar chart we can see the trends across the different debt types very clearly as time goes on. We can see when certain type of debt increase compared to other debt and we can still see the total debt as the sum of the bars. Trying to do a grouped bar chart would be very hard to see with the smaller debt bars being dwarfed by the mortgage bars, and the graph would be too wide and the bars would be very skinny. \n",
    "supporting": [
      "DanielHannon_challenge6_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}