{
  "hash": "a66d745a624f7416146be6273bdc62d6",
  "result": {
    "markdown": "---\ntitle: \"Challenge 8\"\nauthor: \"Connor Landreth\"\ndescription: \"Joining Data\"\ndate: \"2023-04-29\"\nformat:\n  html:\n    toc: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - challenge_8\n  - FAO & Bird Remake\n\n\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(knitr)\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(readxl)\nlibrary(lubridate)\nlibrary(here)\nlibrary(ggthemes)\n\nknitr::opts_chunk$set(echo = TRUE, warning=FALSE, message=FALSE)\n\ngetwd()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"C:/Github Projects/601_Spring_2023/posts\"\n```\n:::\n\n```{.r .cell-code}\nsetwd(\"C:/Github Projects/601_Spring_2023/posts/_data\")\n```\n:::\n\n\n\n\n## Read in data\n\nRead in one (or more) of the following datasets, using the correct R package and command.\n\n  - FAO\n  - bird\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readxl)\nsetwd(\"C:/Github Projects/601_Spring_2023/posts/_data\")\n#milmar <- read_excel(\"ActiveDuty_MaritalStatus.xls\")\n#Amar <- read.csv(\"australian_marriage_tidy.csv\")\nbirds <- read.csv(\"birds.csv\")\nfao <- read.csv(\"FAOSTAT_country_groups.csv\")\n```\n:::\n\nGoing to work through the fao and bird joining example. First, rename variables \n\n\n::: {.cell}\n\n```{.r .cell-code}\nfao <- fao %>% \n  select(Country.Group, Country)%>%\n  rename(country_group = \"Country.Group\")%>%\n  distinct()\n\nfao %>% \n  filter(country_group == \"Southern Europe\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     country_group                      Country\n1  Southern Europe                      Albania\n2  Southern Europe                      Andorra\n3  Southern Europe       Bosnia and Herzegovina\n4  Southern Europe                      Croatia\n5  Southern Europe                    Gibraltar\n6  Southern Europe                       Greece\n7  Southern Europe                     Holy See\n8  Southern Europe                        Italy\n9  Southern Europe                       Kosovo\n10 Southern Europe                        Malta\n11 Southern Europe                   Montenegro\n12 Southern Europe              North Macedonia\n13 Southern Europe                     Portugal\n14 Southern Europe                   San Marino\n15 Southern Europe                       Serbia\n16 Southern Europe        Serbia and Montenegro\n17 Southern Europe                     Slovenia\n18 Southern Europe Southern Europe, unspecified\n19 Southern Europe                        Spain\n20 Southern Europe                 Yugoslav SFR\n```\n:::\n:::\n\nKnit table with country groups and associated country groups\n\n::: {.cell}\n\n```{.r .cell-code}\ntemp<-fao%>%\n  group_by(country_group)%>%\n  summarize(n=n())%>%\n  arrange(desc(n))\nhalf <-c(1:round(nrow(temp)/2))\nknitr::kable(list(temp[half,],  \n           matrix(numeric(), nrow=0, ncol=1),\n           temp[-half,]), \n           caption = \"# Coutnries by Country Groups\")%>%\n  kableExtra::kable_styling(font_size=15)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"kable_wrapper table\" style=\"font-size: 15px; margin-left: auto; margin-right: auto;\">\n<caption style=\"font-size: initial !important;\"># Coutnries by Country Groups</caption>\n<tbody>\n  <tr>\n   <td> \n\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> country_group </th>\n   <th style=\"text-align:right;\"> n </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> World </td>\n   <td style=\"text-align:right;\"> 277 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Non-Annex I countries </td>\n   <td style=\"text-align:right;\"> 161 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Net Food Importing Developing Countries </td>\n   <td style=\"text-align:right;\"> 81 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Annex I countries </td>\n   <td style=\"text-align:right;\"> 78 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> High-income economies </td>\n   <td style=\"text-align:right;\"> 64 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Africa </td>\n   <td style=\"text-align:right;\"> 63 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Europe </td>\n   <td style=\"text-align:right;\"> 63 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Americas </td>\n   <td style=\"text-align:right;\"> 61 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Small Island Developing States </td>\n   <td style=\"text-align:right;\"> 58 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Upper-middle-income economies </td>\n   <td style=\"text-align:right;\"> 56 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Low Income Food Deficit Countries </td>\n   <td style=\"text-align:right;\"> 55 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Asia </td>\n   <td style=\"text-align:right;\"> 54 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Sub-Saharan Africa </td>\n   <td style=\"text-align:right;\"> 53 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Latin America and the Caribbean </td>\n   <td style=\"text-align:right;\"> 52 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Least Developed Countries </td>\n   <td style=\"text-align:right;\"> 51 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Sub-Saharan Africa (including Sudan) </td>\n   <td style=\"text-align:right;\"> 49 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Lower-middle-income economies </td>\n   <td style=\"text-align:right;\"> 46 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Northern America and Europe </td>\n   <td style=\"text-align:right;\"> 44 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> OECD </td>\n   <td style=\"text-align:right;\"> 36 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Oceania </td>\n   <td style=\"text-align:right;\"> 35 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Low income economies </td>\n   <td style=\"text-align:right;\"> 34 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Land Locked Developing Countries </td>\n   <td style=\"text-align:right;\"> 32 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Caribbean </td>\n   <td style=\"text-align:right;\"> 30 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> European Union (27) </td>\n   <td style=\"text-align:right;\"> 30 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Western Asia and Northern Africa </td>\n   <td style=\"text-align:right;\"> 24 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Eastern Africa </td>\n   <td style=\"text-align:right;\"> 23 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Eastern Asia and South-eastern Asia </td>\n   <td style=\"text-align:right;\"> 20 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Southern Europe </td>\n   <td style=\"text-align:right;\"> 20 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Western Asia </td>\n   <td style=\"text-align:right;\"> 20 </td>\n  </tr>\n</tbody>\n</table>\n\n </td>\n   <td> \n\n<table>\n<tbody>\n  <tr>\n\n  </tr>\n</tbody>\n</table>\n\n </td>\n   <td> \n\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> country_group </th>\n   <th style=\"text-align:right;\"> n </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Northern Europe </td>\n   <td style=\"text-align:right;\"> 18 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Oceania excluding Australia and New Zealand </td>\n   <td style=\"text-align:right;\"> 18 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Western Africa </td>\n   <td style=\"text-align:right;\"> 18 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> South America </td>\n   <td style=\"text-align:right;\"> 17 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Central Asia and Southern Asia </td>\n   <td style=\"text-align:right;\"> 14 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> North and Central America </td>\n   <td style=\"text-align:right;\"> 14 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Western Asia (exc. Armenia, Azerbaijan, Cyprus, Israel and Georgia) </td>\n   <td style=\"text-align:right;\"> 13 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Eastern Europe </td>\n   <td style=\"text-align:right;\"> 12 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Polynesia </td>\n   <td style=\"text-align:right;\"> 12 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> South-eastern Asia </td>\n   <td style=\"text-align:right;\"> 11 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Western Europe </td>\n   <td style=\"text-align:right;\"> 11 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Micronesia </td>\n   <td style=\"text-align:right;\"> 10 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Eastern Asia </td>\n   <td style=\"text-align:right;\"> 9 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Middle Africa </td>\n   <td style=\"text-align:right;\"> 9 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Southern Asia </td>\n   <td style=\"text-align:right;\"> 9 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Caucasus and Central Asia </td>\n   <td style=\"text-align:right;\"> 8 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Central America </td>\n   <td style=\"text-align:right;\"> 8 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Northern Africa </td>\n   <td style=\"text-align:right;\"> 8 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Southern Asia (excluding India) </td>\n   <td style=\"text-align:right;\"> 8 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Australia and New Zealand </td>\n   <td style=\"text-align:right;\"> 6 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Eastern Asia (excluding Japan) </td>\n   <td style=\"text-align:right;\"> 6 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Northern Africa (excluding Sudan) </td>\n   <td style=\"text-align:right;\"> 6 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Northern America </td>\n   <td style=\"text-align:right;\"> 6 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Central Asia </td>\n   <td style=\"text-align:right;\"> 5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Melanesia </td>\n   <td style=\"text-align:right;\"> 5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Southern Africa </td>\n   <td style=\"text-align:right;\"> 5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Eastern Asia (excluding China) </td>\n   <td style=\"text-align:right;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Eastern Asia (excluding Japan and China) </td>\n   <td style=\"text-align:right;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Antarctic Region </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n</tbody>\n</table>\n\n </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfao%>%\n  summarise(n=n())/277\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n        n\n1 7.01444\n```\n:::\n:::\n\nNested sub regions within regions:\n\n::: {.cell}\n\n```{.r .cell-code}\nfao%>%\n  filter(str_detect(country_group, \"[aA]nnex\"))%>%\n  group_by(country_group)%>%\n  summarise(n=n())\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 × 2\n  country_group             n\n  <chr>                 <int>\n1 Annex I countries        78\n2 Non-Annex I countries   161\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfao%>%\n  filter(str_detect(country_group, \"[aA]nnex\"))%>%\n  summarise(n=n())\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    n\n1 239\n```\n:::\n:::\n\n\n## Join Data - Combine data sets (marriage & debt)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfao%>%\n  filter(str_detect(country_group, \"[iI]ncome\"))%>%\n  group_by(country_group)%>%\n  summarise(n=n())\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 × 2\n  country_group                         n\n  <chr>                             <int>\n1 High-income economies                64\n2 Low income economies                 34\n3 Low Income Food Deficit Countries    55\n4 Lower-middle-income economies        46\n5 Upper-middle-income economies        56\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfao%>%\n  filter(str_detect(country_group, \"[iI]ncome\"))%>%\n  summarise(n=n())\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    n\n1 255\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfao%>%\n  filter(str_detect(country_group, \"[Dd]evelop|OECD\"))%>%\n  group_by(country_group)%>%\n  summarise(n=n())\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 × 2\n  country_group                               n\n  <chr>                                   <int>\n1 Land Locked Developing Countries           32\n2 Least Developed Countries                  51\n3 Net Food Importing Developing Countries    81\n4 OECD                                       36\n5 Small Island Developing States             58\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfao%>%\n  filter(str_detect(country_group, \"[Dd]evelop|OECD\"))%>%\n  summarise(n=n())\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    n\n1 258\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmajor_regions<-c(\"Africa\", \"Asia\", \"Europe\", \"Americas\", \n                 \"Oceania\", \"Antarctic Region\")\n\nfao%>%\n  filter(country_group %in% major_regions)%>%\n  summarise(n=n())\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    n\n1 277\n```\n:::\n:::\n\nCreate new categorical variables for the country groups for data set.\n\n::: {.cell}\n\n```{.r .cell-code}\nfao_regions_wide<-fao%>%\n  filter(country_group!=\"World\")%>%\n  pivot_wider(names_from=country_group, values_from = 1)%>%\n  unite(\"gp_annex\", contains(\"Annex\"), \n        sep=\"\", na.rm=TRUE, remove=TRUE)%>%\n  unite(\"gp_major_region\", any_of(major_regions), \n        sep=\"\", na.rm=TRUE, remove=TRUE)%>%\n  unite(\"gp_income\", contains(\"Income\")|contains(\"income\"),\n        sep=\"\", na.rm=TRUE, remove=TRUE)%>%\n  unite(\"gp_develop\", contains(\"Develop\")|contains(\"OECD\"),\n        sep=\"\", na.rm=TRUE, remove=TRUE)%>%\n  select(Country, starts_with(\"gp\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnrow(birds)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 30977\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nbirds <- left_join(birds, fao_regions_wide,\n                   by = c(\"Area\" = \"Country\"))\n```\n:::\n\n\nThen we can summarize the data across the countries \n\n::: {.cell}\n\n```{.r .cell-code}\neggs_chicken <- here(\"posts\",\"_data\",\"FAOSTAT_egg_chicken.csv\") %>%\n  read_csv()\ncattle <- here(\"posts\",\"_data\",\"FAOSTAT_egg_chicken.csv\") %>%\n  read_csv()\ndat <- left_join(eggs_chicken, cattle, by=\"Area\")\n```\n:::\n\n\n\n\n\n\n\n\n\n##tapply(pseo$p50_earnings,pseo$deglevl,mean, na.rm = TRUE)\n\n##cor(pseo$p50_earnings,pseo$year_postgrad, use=\"pairwise.complete.obs\")\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/kePrint-0.0.1/kePrint.js\"></script>\r\n<link href=\"../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}